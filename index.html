<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gesti√≥n - Calidad en Software | StudyQuality</title>
    <meta name="description" content="Sistema de gesti√≥n de usuarios basado en principios de calidad de software de Guillermo Pantaleo">
    <meta name="keywords" content="calidad software, gesti√≥n usuarios, pruebas automatizadas, integraci√≥n continua">
    <meta name="author" content="StudyQuality NRC2849">
    
    <!-- Favicons -->
    <link rel="icon" href="./assets/icons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="./assets/icons/apple-touch-icon.png">
    
    <!-- CSS Modules -->
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/auth.css">
    <link rel="stylesheet" href="./css/dashboard.css">
    <link rel="stylesheet" href="./css/users.css">
    <link rel="stylesheet" href="./css/modals.css">
    <link rel="stylesheet" href="./css/reports.css">
    <link rel="stylesheet" href="./css/responsive.css">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Sistema de Gesti√≥n - StudyQuality">
    <meta property="og:description" content="Prototipo de calidad de software basado en principios de Pantaleo">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://devcatalitico.github.io/StudyQuality_nrc2849/">
    <meta property="og:image" content="https://devcatalitico.github.io/StudyQuality_nrc2849/assets/images/og-image.png">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2>StudyQuality</h2>
            <p>Cargando sistema de calidad...</p>
        </div>
    </div>

    <div class="container">
        <!-- Header Principal -->
        <header class="header">
            <div class="header-content">
                <h1>Sistema de Gesti√≥n de Usuarios</h1>
                <p>Prototipo basado en principios de Calidad de Software - Pantaleo</p>
                <div class="version-info">
                    <span class="version">v1.0.0</span>
                    <span class="build">Build: CI-2024</span>
                </div>
            </div>
        </header>

        <!-- Secci√≥n de Autenticaci√≥n -->
        <section id="authSection" class="auth-section">
            <div class="auth-container">
                <div class="auth-tabs">
                    <button class="tab-button active" data-tab="login">Iniciar Sesi√≥n</button>
                    <button class="tab-button" data-tab="register">Registrarse</button>
                </div>

                <!-- Tab de Login -->
                <div id="loginTab" class="tab-content active">
                    <div class="form-header">
                        <h2>Iniciar Sesi√≥n</h2>
                        <p>Accede al sistema de gesti√≥n</p>
                    </div>
                    <form id="loginForm" class="auth-form">
                        <div class="form-group">
                            <label for="loginEmail">Email:</label>
                            <input type="email" id="loginEmail" required autocomplete="email">
                            <span class="form-error" id="loginEmailError"></span>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Contrase√±a:</label>
                            <div class="password-field">
                                <input type="password" id="loginPassword" required autocomplete="current-password">
                                <button type="button" class="password-toggle" data-target="loginPassword">üëÅÔ∏è</button>
                            </div>
                            <span class="form-error" id="loginPasswordError"></span>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <span class="btn-text">Ingresar</span>
                            <span class="btn-spinner"></span>
                        </button>
                    </form>
                    <div class="demo-credentials">
                        <h4>Credenciales de Demo:</h4>
                        <p><strong>Email:</strong> admin@demo.com</p>
                        <p><strong>Contrase√±a:</strong> demo123</p>
                    </div>
                </div>

                <!-- Tab de Registro -->
                <div id="registerTab" class="tab-content">
                    <div class="form-header">
                        <h2>Crear Cuenta</h2>
                        <p>Reg√≠strate en el sistema</p>
                    </div>
                    <form id="registerForm" class="auth-form">
                        <div class="form-group">
                            <label for="regName">Nombre Completo:</label>
                            <input type="text" id="regName" required autocomplete="name">
                            <span class="form-error" id="regNameError"></span>
                        </div>
                        <div class="form-group">
                            <label for="regEmail">Email:</label>
                            <input type="email" id="regEmail" required autocomplete="email">
                            <span class="form-error" id="regEmailError"></span>
                        </div>
                        <div class="form-group">
                            <label for="regPassword">Contrase√±a:</label>
                            <div class="password-field">
                                <input type="password" id="regPassword" required autocomplete="new-password">
                                <button type="button" class="password-toggle" data-target="regPassword">üëÅÔ∏è</button>
                            </div>
                            <div class="password-strength" id="passwordStrength"></div>
                            <span class="form-error" id="regPasswordError"></span>
                        </div>
                        <div class="form-group">
                            <label for="regRole">Rol:</label>
                            <select id="regRole" required>
                                <option value="">Seleccionar rol</option>
                                <option value="user">Usuario</option>
                                <option value="admin">Administrador</option>
                            </select>
                            <span class="form-error" id="regRoleError"></span>
                        </div>
                        <button type="submit" class="btn btn-success">
                            <span class="btn-text">Registrarse</span>
                            <span class="btn-spinner"></span>
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Dashboard Principal -->
        <main id="dashboard" class="dashboard">
            <!-- Header del Dashboard -->
            <div class="dashboard-header">
                <div class="user-info">
                    <div class="avatar" id="userAvatar">A</div>
                    <div class="user-details">
                        <h3 id="userName">Usuario Administrador</h3>
                        <p id="userRole">Administrador del Sistema</p>
                        <span class="user-status online" id="userStatus">En l√≠nea</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-outline" id="notificationsBtn">
                        üîî <span class="notification-count">3</span>
                    </button>
                    <button class="btn btn-danger" id="logoutBtn">Cerrar Sesi√≥n</button>
                </div>
            </div>

            <!-- Estad√≠sticas del Sistema -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <h3 id="totalUsers">0</h3>
                            <p>Usuarios Registrados</p>
                            <span class="stat-trend up">+12% este mes</span>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <h3 id="activeUsers">0</h3>
                            <p>Usuarios Activos</p>
                            <span class="stat-trend up">+8% esta semana</span>
                        </div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-content">
                            <h3 id="systemUptime">99.5%</h3>
                            <p>Disponibilidad</p>
                            <span class="stat-trend stable">Estable</span>
                        </div>
                    </div>
                    <div class="stat-card info">
                        <div class="stat-icon">‚ö°</div>
                        <div class="stat-content">
                            <h3 id="avgResponseTime">24ms</h3>
                            <p>Tiempo de Respuesta</p>
                            <span class="stat-trend down">-15% optimizado</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Navegaci√≥n de M√≥dulos -->
            <nav class="module-nav">
                <button class="module-btn active" data-module="users">
                    <span class="module-icon">üë•</span>
                    <span class="module-text">Gesti√≥n de Usuarios</span>
                </button>
                <button class="module-btn" data-module="reports">
                    <span class="module-icon">üìä</span>
                    <span class="module-text">Reportes</span>
                </button>
                <button class="module-btn" data-module="analytics">
                    <span class="module-icon">üìà</span>
                    <span class="module-text">An√°lisis</span>
                </button>
                <button class="module-btn" data-module="settings">
                    <span class="module-icon">‚öôÔ∏è</span>
                    <span class="module-text">Configuraci√≥n</span>
                </button>
            </nav>

            <!-- M√≥dulo de Gesti√≥n de Usuarios -->
            <section id="usersModule" class="module-content active">
                <div class="module-header">
                    <h2>Gesti√≥n de Usuarios</h2>
                    <div class="module-actions">
                        <button class="btn btn-primary" id="addUserBtn">
                            <span class="btn-icon">‚ûï</span>
                            Agregar Usuario
                        </button>
                        <button class="btn btn-outline" id="bulkActionsBtn">
                            <span class="btn-icon">‚öôÔ∏è</span>
                            Acciones Masivas
                        </button>
                    </div>
                </div>

                <!-- Filtros y B√∫squeda -->
                <div class="filters-section">
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Buscar usuarios por nombre o email...">
                        <button class="search-btn">üîç</button>
                    </div>
                    <div class="filter-controls">
                        <select id="statusFilter" class="filter-select">
                            <option value="">Todos los estados</option>
                            <option value="active">Activos</option>
                            <option value="inactive">Inactivos</option>
                        </select>
                        <select id="roleFilter" class="filter-select">
                            <option value="">Todos los roles</option>
                            <option value="admin">Administradores</option>
                            <option value="user">Usuarios</option>
                        </select>
                        <button class="btn btn-outline" id="clearFiltersBtn">Limpiar Filtros</button>
                    </div>
                </div>

                <!-- Tabla de Usuarios -->
                <div class="table-container">
                    <table class="users-table" id="usersTable">
                        <thead>
                            <tr>
                                <th>
                                    <input type="checkbox" id="selectAllUsers">
                                </th>
                                <th data-sort="id">ID <span class="sort-indicator"></span></th>
                                <th data-sort="name">Nombre <span class="sort-indicator"></span></th>
                                <th data-sort="email">Email <span class="sort-indicator"></span></th>
                                <th data-sort="role">Rol <span class="sort-indicator"></span></th>
                                <th data-sort="status">Estado <span class="sort-indicator"></span></th>
                                <th data-sort="registeredDate">Fecha de Registro <span class="sort-indicator"></span></th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Los usuarios se cargar√°n din√°micamente -->
                        </tbody>
                    </table>
                </div>

                <!-- Paginaci√≥n -->
                <div class="pagination-container">
                    <div class="pagination-info">
                        Mostrando <span id="paginationStart">1</span>-<span id="paginationEnd">10</span> de <span id="paginationTotal">0</span> usuarios
                    </div>
                    <div class="pagination-controls">
                        <button class="btn btn-outline" id="prevPageBtn" disabled>‚Üê Anterior</button>
                        <div class="page-numbers" id="pageNumbers"></div>
                        <button class="btn btn-outline" id="nextPageBtn">Siguiente ‚Üí</button>
                    </div>
                </div>
            </section>

            <!-- M√≥dulo de Reportes -->
            <section id="reportsModule" class="module-content">
                <div class="module-header">
                    <h2>Reportes y An√°lisis</h2>
                    <div class="module-actions">
                        <button class="btn btn-primary" id="generateReportBtn">
                            <span class="btn-icon">üìÑ</span>
                            Generar Reporte
                        </button>
                    </div>
                </div>

                <div class="reports-grid">
                    <div class="report-card">
                        <h3>Reporte de Usuarios</h3>
                        <p>Estad√≠sticas completas de usuarios registrados</p>
                        <button class="btn btn-primary" data-report="users">Generar</button>
                    </div>
                    <div class="report-card">
                        <h3>Reporte de Actividad</h3>
                        <p>An√°lisis de actividad y uso del sistema</p>
                        <button class="btn btn-primary" data-report="activity">Generar</button>
                    </div>
                    <div class="report-card">
                        <h3>Exportar Datos</h3>
                        <p>Exportar informaci√≥n en m√∫ltiples formatos</p>
                        <div class="export-buttons">
                            <button class="btn btn-outline" data-export="csv">CSV</button>
                            <button class="btn btn-outline" data-export="json">JSON</button>
                            <button class="btn btn-outline" data-export="pdf">PDF</button>
                        </div>
                    </div>
                </div>

                <!-- √Årea de Gr√°ficos -->
                <div class="charts-section">
                    <div class="chart-container">
                        <div class="chart-placeholder">
                            <h3>üìä Gr√°fico de Usuarios por Mes</h3>
                            <p>Visualizaci√≥n de crecimiento de usuarios</p>
                            <div class="mock-chart">
                                <div class="chart-bars">
                                    <div class="bar" style="height: 40%"></div>
                                    <div class="bar" style="height: 60%"></div>
                                    <div class="bar" style="height: 80%"></div>
                                    <div class="bar" style="height: 45%"></div>
                                    <div class="bar" style="height: 90%"></div>
                                    <div class="bar" style="height: 70%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- M√≥dulo de An√°lisis -->
            <section id="analyticsModule" class="module-content">
                <div class="module-header">
                    <h2>An√°lisis del Sistema</h2>
                </div>
                <div class="analytics-content">
                    <div class="ci-status">
                        <h3>Estado de Integraci√≥n Continua</h3>
                        <div class="ci-pipeline" id="ciPipeline">
                            <!-- Pipeline status se carga din√°micamente -->
                        </div>
                    </div>
                    <div class="performance-metrics">
                        <h3>M√©tricas de Rendimiento</h3>
                        <div class="metrics-grid" id="performanceMetrics">
                            <!-- M√©tricas se cargan din√°micamente -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- M√≥dulo de Configuraci√≥n -->
            <section id="settingsModule" class="module-content">
                <div class="module-header">
                    <h2>Configuraci√≥n del Sistema</h2>
                </div>
                <div class="settings-content">
                    <div class="settings-section">
                        <h3>Gesti√≥n de Datos</h3>
                        <div class="settings-actions">
                            <button class="btn btn-warning" id="backupBtn">Crear Respaldo</button>
                            <button class="btn btn-primary" id="restoreBtn">Restaurar Datos</button>
                            <button class="btn btn-success" id="runCiBtn">Ejecutar CI/CD</button>
                        </div>
                    </div>
                    <div class="settings-section">
                        <h3>Configuraci√≥n de Pruebas</h3>
                        <div class="test-controls">
                            <button class="btn btn-outline" id="runTestsBtn">Ejecutar Pruebas</button>
                            <button class="btn btn-outline" id="showMetricsBtn">Ver M√©tricas</button>
                            <button class="btn btn-outline" id="viewLogsBtn">Ver Logs</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Sistema de Notificaciones -->
        <div id="notificationContainer" class="notification-container"></div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay">
            <div class="loading-content">
                <div class="spinner"></div>
                <p id="loadingMessage">Procesando...</p>
            </div>
        </div>
    </div>

    <!-- Modal para Gesti√≥n de Usuarios -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Agregar Usuario</h2>
                <button class="modal-close" id="closeModalBtn">&times;</button>
            </div>
            <form id="userForm" class="modal-form">
                <input type="hidden" id="editUserId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalName">Nombre Completo:</label>
                        <input type="text" id="modalName" required>
                        <span class="form-error" id="modalNameError"></span>
                    </div>
                    <div class="form-group">
                        <label for="modalEmail">Email:</label>
                        <input type="email" id="modalEmail" required>
                        <span class="form-error" id="modalEmailError"></span>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="modalRole">Rol:</label>
                        <select id="modalRole" required>
                            <option value="">Seleccionar rol</option>
                            <option value="user">Usuario</option>
                            <option value="admin">Administrador</option>
                        </select>
                        <span class="form-error" id="modalRoleError"></span>
                    </div>
                    <div class="form-group">
                        <label for="modalStatus">Estado:</label>
                        <select id="modalStatus" required>
                            <option value="active">Activo</option>
                            <option value="inactive">Inactivo</option>
                        </select>
                        <span class="form-error" id="modalStatusError"></span>
                    </div>
                </div>
                <div class="form-group">
                    <label for="modalNotes">Notas:</label>
                    <textarea id="modalNotes" rows="3" placeholder="Informaci√≥n adicional del usuario..."></textarea>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-success">
                        <span class="btn-text">Guardar</span>
                        <span class="btn-spinner"></span>
                    </button>
                    <button type="button" class="btn btn-danger" id="cancelModalBtn">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- JavaScript Bundle - Versi√≥n compatible con GitHub Pages -->
    <script src="./js/studyquality-bundle.js"></script>
    
    <!-- Fallback en caso de error cargando el bundle -->
    <script>
        setTimeout(function() {
            if (!window.studyQualityApp) {
                console.warn('‚ö†Ô∏è Bundle no se carg√≥, iniciando versi√≥n de emergencia');
                
                // Ocultar pantalla de carga
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.display = 'none';
                }
                
                // Mostrar formulario de login b√°sico
                const authSection = document.getElementById('authSection');
                if (authSection) {
                    authSection.style.display = 'block';
                }
                
                // Configurar funcionalidad de pesta√±as
                const tabButtons = document.querySelectorAll('.tab-button');
                tabButtons.forEach(function(button) {
                    button.addEventListener('click', function(e) {
                        const targetTab = e.target.getAttribute('data-tab');
                        
                        // Remover active de todos
                        tabButtons.forEach(function(btn) { btn.classList.remove('active'); });
                        document.querySelectorAll('.tab-content').forEach(function(content) { 
                            content.classList.remove('active'); 
                        });
                        
                        // Activar seleccionado
                        e.target.classList.add('active');
                        const targetContent = document.getElementById(targetTab + 'Tab');
                        if (targetContent) {
                            targetContent.classList.add('active');
                        }
                    });
                });
                
                // Configurar funcionalidad b√°sica de demo
                const demoBtn = document.getElementById('demoCredentialsBtn');
                if (demoBtn) {
                    demoBtn.addEventListener('click', function() {
                        const emailInput = document.getElementById('loginEmail');
                        const passwordInput = document.getElementById('loginPassword');
                        if (emailInput) emailInput.value = 'admin@demo.com';
                        if (passwordInput) passwordInput.value = 'demo123';
                        alert('Credenciales demo cargadas: admin@demo.com / demo123');
                    });
                }
                
                // Funcionalidad b√°sica de login
                const loginForm = document.getElementById('loginForm');
                if (loginForm) {
                    loginForm.addEventListener('submit', function(e) {
                        e.preventDefault();
                        const email = document.getElementById('loginEmail').value;
                        const password = document.getElementById('loginPassword').value;
                        
                        if (email === 'admin@demo.com' && password === 'demo123') {
                            document.getElementById('authSection').style.display = 'none';
                            document.getElementById('dashboardSection').style.display = 'block';
                            document.getElementById('userName').textContent = 'Administrador Demo';
                            document.getElementById('userEmail').textContent = email;
                            alert('‚úÖ Login exitoso - StudyQuality NRC2849');
                        } else {
                            alert('‚ùå Credenciales incorrectas. Use: admin@demo.com / demo123');
                        }
                    });
                }
                
                console.log('‚úÖ Versi√≥n de emergencia activada');
            }
        }, 3000);
    </script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>